{{#template name="tutorials.socially.angular1.step_16.md"}}
{{> downloadPreviousStep stepName="step_15"}}

Добавьте локацию к нашим вечеринкам.

Наиболее популярным виджетом для выода карт является Google Maps, давайте установим пакет для его вывода.


    meteor add angularui:angular-google-maps


Определим зависимости в модуле нашего приложения, перейдите в `app.js` всередину папки `client/lib`:

{{> DiffBox tutorialName="meteor-angular1-socially" step="16.2"}}

Добавим карту к `party-details.html`, вначале добавим этот HTML кусок в конец шаблона:

{{> DiffBox tutorialName="meteor-angular1-socially" step="16.3"}}

Здесь мы создали директиву google-map с атрибутами для связывания центра, управления событиями и увеличения карты.
Давайте определим эти переменные в нашем компоненте. Перейдём в компонент `partyDetails`.

Всередине мы создадим переменную `this.map` для содержания свойств карты:

{{> DiffBox tutorialName="meteor-angular1-socially" step="16.4"}}

Для вывода виджета Google Map нам нужно определить его высоту и ширину. Давайте сделаем это.
Создадим новый файл с названием `google-maps.css` всередине новой папки с названием `styles` таким образом `client->parties->styles` и поместим туда следующий CSS код:

{{> DiffBox tutorialName="meteor-angular1-socially" step="16.5"}}

Теперь запустим приложение и перейдём на страницу деталей вечеринки. Вы должны увидеть новый Google Map виджет, но это ничего не значит.

Давайте добавим маркер, который будет привязан к местоположению вечеринки.

Всередине `party-details.html`:

{{> DiffBox tutorialName="meteor-angular1-socially" step="16.6"}}

Директива `ui-gmap-marker` представляет маркер всередине карты. Мы используем следующие аттрибуты:

* coords - область, к которой будет привязано местоположение.
* options - объект, который содержит опции маркера. Мы будем использовать опцию draggable.
* events - обрабатывание событий маркера. Мы будем использовать событие click.
* idKey - область, где существует уникальный id объекта, который представляет маркер.

Давайте расширим нашу переменную `this.map`для включения содержания этих опций:

Всередине компонента `partyDetails`:

{{> DiffBox tutorialName="meteor-angular1-socially" step="16.7"}}

Что здесь происходит:

* Мы добавили событие click к карте. Каждый раз, когда пользователь нажимает на карту, мы берём положение от параметров click события и сохраняем его как новое положение вечеринки.
* Мы определили объект событий под маркером для определения маркера обладающего свойством draggable.
* Мы обработали событие "тянуть", которое произошло, когда маркер переместили на новое место. Мы взяли место из параметров события и сохранили их как новое место вечеринки.

Снова с отличной Meteor платформой нет необходимости синхронизировать и сохранять. Мы просто установили и оно само синхронизировалось с остальными клиентами.

Протестируйте его реакцию на клики и перетягивание.


# Различные маркеры

Давайте добавим карту к списку вечеринок, чтобы показать все вечеринки на карте.

Давайте добавим директивы к `parties-list.html`:

{{> DiffBox tutorialName="meteor-angular1-socially" step="16.8"}}

Добавьте их под search и sorting div.

Как видите вся разница между директивами, которые мы использовали в `party-details.html` в том, что `ui-gmap-markers` множественная.

Атрибуты, что мы использовали.

* models - массив области, который представляет маркеры.
* coords - свойство, которое содержит место.
* click - обработчик события нажатия на маркер.
* fit - boolean для  автоматического увеличения карты, чтобы поместились внутри все маркера
* idKey - свойство, содержащее все уникальные id массива
* doRebuildAll - функция обновления, которая поможет нам обновить маркера в поиске

Теперь всередине компонента `partiesList` добавим следующий код:

{{> DiffBox tutorialName="meteor-angular1-socially" step="16.9"}}

Что мы только что сделали?

* Добавили к каждой вечеринке функцию, которая обрабатывает событие нажатия с соответствующей информацией
* Инициализация объекта карты

# Итоги

Запустите приложение. Посмотрите сколько мало кода нужно для карты в нашем приложении.

Angular 1 имеет огромную эко-систему полную классных директив таких как angular-google-maps, например.

{{/template}}