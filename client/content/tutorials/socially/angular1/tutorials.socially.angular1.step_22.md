{{#template name="tutorials.socially.angular1.step_22.md"}}
{{> downloadPreviousStep stepName="step_21"}}

Ionic это CSS и JavaScript фреймоврк. Очень рекомендую перед тем, как начинать этот урок ознакомиться с  [документацией](http://ionicframework.com/docs/).

На этом этапе научимся добавлять библиотеку Ionic к нашему проекту и использовать её мощные директивы для создания кроссплатформенных мобильных (Android & iOS) приложений. 

Достигнем этого через создание различных отображений для веб и мобильных устройств, то есть мы создадим отдельное отображение для мобильных приложений, но будем держать расшаренные части как общий код!

### Разделение файла основного отображения

У нас уже есть компонент `socially`, который является главным для браузера, поэтому нам нужно его переместить в пакет браузера и обновить его имя AngularJS модуля:

{{> DiffBox tutorialName="meteor-angular1-socially" step="22.1" filename="packages/socially-browser/client/socially/socially.component.js"}}

> Обратите внимание, что мы сменили путь `templateUrl`.

Давайте обновим `package.js` пакета `socially-browser`:

{{> DiffBox tutorialName="meteor-angular1-socially" step="22.2"}}

Поняли в чём смысл - сделаем тоже с подпиской, сбросом пароля, списком вечеринок, добавим новое модальное окно вечеринки и отображение деталей вечеринки.

Я сделал это [в этом коммите](https://github.com/Urigo/meteor-angular-socially/commit/89b159e7e6b42a2540e8886ca6f82f5364ff4f88), и обновил `package.js` в [этом коммите](https://github.com/Urigo/meteor-angular-socially/commit/f4e927d21fc8fa74f008eec9230f534f9defa7fb).

Также, фильтры - это одна из вещей, которые мы можем сделать прямо сейчас, так как мы можем использовать их в Mobile и Browser, поэтому уберём их из папки `parties`, но по-прежнему будем содержать в корне проекта (поменял их в [этом коммите](https://github.com/Urigo/meteor-angular-socially/commit/b078a263799e817b7381de516f1ff43559ee7c1b))

На этом этапе - вы должно быть поняли, что нам нужно будет реализовать всю логику компонентов снова - но не волнуйтесь! В следующих шагах этого урока, мы возьмём некоторую логику и используем как "общую" логику для обеих платформ!

### Добавление Ionic

Использование ionic очень просто - сперва нам нужно добавить зависимость в `package.js` нашего `socially-mobile`:

{{> DiffBox tutorialName="meteor-angular1-socially" step="22.6"}}

Ionic основан на AngularJS, так что нам также нужно загрузить `ionic` как зависимость модуля в модуле `socially.mobile`:

{{> DiffBox tutorialName="meteor-angular1-socially" step="22.7"}}

Теперь мы будем использовать Ionic и создадим отображение `socially` снова, теперь с директивами ionic.

Этот простой макет навигации скопирован с документации Ionic.

{{> DiffBox tutorialName="meteor-angular1-socially" step="22.9" filename="packages/socially-mobile/client/socially/socially.html"}}

> Тег `ion-nav-view` схож с тегом `ui-view`, поэтому мы можем использовать тот же (`main`) здесь.

И добавим его к `package.js`:

{{> DiffBox tutorialName="meteor-angular1-socially" step="22.10"}}

и теперь компонент:

{{> DiffBox tutorialName="meteor-angular1-socially" step="22.8"}}

Хей! Это же та же логика компонента! Вот именно!

Что мы можем сделать?

Мы можем поделится логикой `socially` и загрузить отображение соответсвенной платформе, которую запускаем в данный момент!

### Расшаривание и создание общих компонентов

Основой расшаривания компонентов является помещение файла `.component.js` в корень проекта и помещение отображения каждой платформы в отдельный пакет.

Таким образом у нас есть отображение в каждом пакете (мобильное и браузера), убедимся, что мы полностью удалили `socially.component.js` из этих пакетов (также из их `package.js`), и поместим реализацию - `socially.component.js` в корень проекта:

{{> DiffBox tutorialName="meteor-angular1-socially" step="22.11"}}

> Использование `templateUrl` - мы можем задать функцию и AngularJS будет использовать её результат как url шаблона.

Теперь у нас *такая же логика* компонента `socially` с единственной разницей - отображением!


### Использование Ionic

Теперь нужно создать отображение списка вечеринок для мобильной платформы, используя директивы Ionic и CSS.

Теперь мы добавим содержимое к списку вечеринок. Это полностью прямой процес с использованием директив Angular и Ionic классов:

{{> DiffBox tutorialName="meteor-angular1-socially" step="22.13"}}

Как и с любым другим файлом всередине пакета, этот также нужно добавить к файлу `package.js`:

{{> DiffBox tutorialName="meteor-angular1-socially" step="22.14"}}

Как мы и делали с компонентом `socially`, мы понимаем, что единственной разницей между мобильным и браузерным списком вечеринок является отображение!

Теперь мы можем вернуть `parties-list.component.js` назад в корень проекта (у убрать его из `package.js`!), используем тот же приём для загрузки `templateUrl`:

{{> DiffBox tutorialName="meteor-angular1-socially" step="22.15"}}

И ... мы закончили!

Мы будем использовать эту технику изученную в Разделе 21 и запускать проект в любимом эмуляторе, я использовал iOS:

    $ meteor run ios

И вот результат:

{{tutorialImage 'angular1' 'step22_1.png' 500}}

## Итоги

В этом уроке мы показали как использовать Ionic и как разделять всё отображение в два разных приложения используя изоляцию пакетов и модули AngularJS.

Мы также научились делиться компонентами между платформами и менять только отображение!

Мы также использовали директивы Ionic для обеспечения user-experience мобильных платформ вместо обычного отзывчивого макета вебсайта.

Используя эти техники мы можем создать отдельный код и логику для каждой платформы, но по-прежнему некоторые части кода (например, AngularJS фильтры, сервисы или компоненты).

{{/template}}